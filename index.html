<!doctype html>
<html lang="vi">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>G·ª≠i B√© Y√™u C·ªßa Trang‚ù§Ô∏è</title>
<style>
:root{
  --bg: #f38dbe;
  --accent: #f77ca3;
  --paper: #faf8f9;
  --text: #2b2b2b;
  --shadow: rgba(12,12,12,0.12);
}

* { box-sizing: border-box; }

html,body{
  height:100%;
  margin:0;
  font-family:"Inter",system-ui;
  background:linear-gradient(180deg,var(--bg),#fff);
  overflow:hidden;
}

.stage{
  height:100%;
  display:flex;
  align-items:center;
  justify-content:center;
  padding:24px;
  position: relative;
}

.card {
  width: min(420px, 90vw);
  aspect-ratio: 9/16;
  display:flex;
  align-items:center;
  justify-content:center;
  position: relative;
  z-index: 5;
}

.click-area{
  width:100%;
  height:100%;
  display:flex;
  align-items:center;
  justify-content:center;
  cursor:pointer;
  position: relative;
}

/* ·∫¢nh n·ªÅn */
.envelope-bg {
  width: 78%;
  max-width: 360px;
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  z-index: 0;
  pointer-events: none;
}

/* Phong b√¨ */
.envelope-wrap {
  width:78%;
  max-width:360px;
  position:relative;
  transition: transform .45s cubic-bezier(.2,.9,.3,1);
  transform-origin:50% 60%;
  z-index:3;
  filter: drop-shadow(0 10px 18px var(--shadow));
  perspective: 800px;
}
.envelope-wrap.idle { animation: float 6s ease-in-out infinite; }
@keyframes float {
  0%{ transform: translateY(0) }
  50%{ transform: translateY(-6px) }
  100%{ transform: translateY(0) }
}
.envelope-body { width: 100%; display:block; position: relative; z-index:3; }
.envelope-lid { position:absolute; top:0; left:0; width:100%; transform-origin:top center; transition: transform 0.6s ease; cursor:pointer; z-index:1; backface-visibility:hidden; }
.envelope-lid.open { transform: rotateX(-100deg); z-index:2; }

/* Note */
.note {
  position:absolute;
  width:85%;
  max-width:320px;
  left:50%;
  top:50%;
  transform:translate(-50%, -50%) scale(0.8);
  background: linear-gradient(180deg, #fff 0%, var(--paper) 100%);
  border-radius:10px;
  box-shadow:0 12px 30px rgba(0,0,0,0.12);
  padding:12px;
  text-align:center;
  opacity:0;
  z-index:4;
  font-size:14px;
}
.note.animate {
  animation: popNote 1.2s ease-out forwards;
}
@keyframes popNote {
  0% { opacity: 0; transform: translate(-50%, -200%) scale(0.8); }
  50% { opacity: 1; transform: translate(-50%, -80%) scale(1.05); }
  100% { opacity: 1; transform: translate(-50%, -50%) scale(1); }
}

/* Letter */
.letter {
  position: fixed;
  top:50%; left:50%;
  transform: translate(-50%, -50%) scale(0);
  width:min(380px,90vw);
  background: linear-gradient(180deg,#fff,#fff9fb);
  border-radius:14px;
  box-shadow:0 18px 40px rgba(0,0,0,0.14);
  padding:20px;
  opacity:0;
  pointer-events:none;
  transform-origin:center;
  transition: all .45s cubic-bezier(.2,.9,.3,1);
  z-index:7;
  max-height:75%;
  overflow:auto;
}
.letter.open { opacity:1; pointer-events:auto; transform:translate(-50%, -50%) scale(1); }

.lines { display:flex; flex-direction:column; gap:10px; margin-top:6px; }
.line { height:10px; background:linear-gradient(90deg,rgba(0,0,0,0.08),rgba(0,0,0,0.04)); border-radius:6px; opacity:0; transform:translateY(6px); transition: all .38s cubic-bezier(.25,.9,.3,1);}
.line.show { opacity:1; transform:translateY(0); }

.letter h3 { margin:0 0 8px; font-size:18px; color:var(--accent); text-align:center; }
.letter p { margin:0; color:var(--text); font-size:15px; line-height:1.45; white-space:pre-line; }

/* Guide */
.guide { position:absolute; bottom:30%; left:50%; transform:translateX(-50%); display:flex; flex-direction:column; align-items:center; animation:fadeIn 1s ease forwards; z-index:10; }
.arrow { width:0; height:0; border-left:14px solid transparent; border-right:14px solid transparent; border-bottom:24px solid var(--accent); animation:bounce 1s infinite alternate; }
.guide-text { margin-top:8px; background: rgba(255,255,255,0.85); padding:8px 14px; border-radius:8px; box-shadow:0 4px 12px rgba(0,0,0,0.15); font-size:14px; color:var(--text); white-space:nowrap; }

@keyframes bounce { 0% { transform: translateY(0); } 100% { transform: translateY(-10px); } }
@keyframes fadeIn { from { opacity:0; transform:translate(-50%,-20%);} to{ opacity:1; transform:translate(-50%,0);} }
@keyframes fadeOut { from{opacity:1;} to{opacity:0;} }

/* Bling & Hearts */
.bling-container { position: fixed; top:0; left:0; width:100%; height:100%; pointer-events:none; overflow:hidden; z-index:1; }
.bling { position:absolute; width:10px; height:10px; background:radial-gradient(white, rgba(255,255,255,0)); box-shadow:0 0 8px white,0 0 14px rgba(255,255,255,0.8); border-radius:50%; opacity:0; animation:bling 3s infinite ease-in-out; }
@keyframes bling { 0%{opacity:0; transform:scale(0.4) translateY(0);} 50%{opacity:1; transform:scale(1.4) translateY(-10px);} 100%{opacity:0; transform:scale(0.4) translateY(0);} }
.heart { position: fixed; bottom:-40px; font-size:22px; color:#ff4d88; opacity:0.8; animation: floatHeart 6s linear infinite; pointer-events:none; z-index:2;}
@keyframes floatHeart { 0%{ transform: translateY(0) translateX(0) scale(0.8) rotate(0deg); opacity:0; } 10%{opacity:0.9;} 50%{ transform:translateY(-50vh) translateX(20px) scale(1) rotate(20deg); opacity:1;} 100%{transform:translateY(-100vh) translateX(-20px) scale(1.2) rotate(-20deg); opacity:0;} }

/* Responsive */
@media (max-width: 480px) {
  .note { width:90%; font-size:13px; }
  .letter { width:90vw; max-height:80%; padding:14px; }
  .letter h3 { font-size:16px; }
  .letter p { font-size:14px; }
}
</style>
</head>
<body>

<!-- Nh·∫°c n·ªÅn -->
<audio id="bgMusic" loop>
  <source src="TNYE1.mp3" type="audio/mpeg">
  Tr√¨nh duy·ªát c·ªßa b·∫°n kh√¥ng h·ªó tr·ª£ audio.
</audio>

<div class="bling-container" id="blingContainer"></div>

<div class="stage">
  <div class="card">
    <div class="click-area" id="clickArea">
      <img src="th∆∞_n·ªÅn.png" alt="·∫£nh n·ªÅn l√° th∆∞" class="envelope-bg">

      <div class="letter" id="letter">
        <h3>Ng∆∞·ªùi Em Y√™u ‚ù§Ô∏è</h3>
        <p id="letterText"></p>
        <div class="lines">
          <div class="line" style="width:90%"></div>
          <div class="line" style="width:85%"></div>
          <div class="line" style="width:95%"></div>
          <div class="line" style="width:80%"></div>
        </div>
      </div>

      <div class="note" id="note">
        <div class="tiny">M·ªôt ƒêi·ªÅu Nho Nh·ªè G·ª≠i ƒê·∫øn H√† üíå</div>
      </div>

      <div class="envelope-wrap idle" id="envelope">
        <img src="th√¢n_2.png" alt="phong b√¨ th√¢n" class="envelope-body">
        <img src="n·∫Øp.png" alt="phong b√¨ n·∫Øp" class="envelope-lid" id="lid">
      </div>

      <div class="guide" id="guide">
        <div class="arrow"></div>
        <div class="guide-text">Nh·∫•n v√¥ l√° th∆∞ ƒë·ªÉ m·ªü nh√© üíå</div>
      </div>

      <div class="guide guide-letter" id="guideLetter" style="display:none;">
        <div class="arrow"></div>
        <div class="guide-text">Nh·∫•n ti·∫øp ƒëi üíå</div>
      </div>

    </div>
  </div>
</div>

<script>
(function(){
  const clickArea = document.getElementById('clickArea');
  const lid = document.getElementById('lid');
  const note = document.getElementById('note');
  const letter = document.getElementById('letter');
  const lines = Array.from(document.querySelectorAll('.line'));
  const envelope = document.getElementById('envelope');
  const guide = document.getElementById('guide');
  const music = document.getElementById('bgMusic');

  let state = 0;

  const fullText = `H√† bi·∫øt H√† cute, xinh x·∫Øn th·∫ø n√†o h√¥ng h·∫£üòò`;
  document.getElementById('letterText').innerText = fullText;

  function openLid(){ lid.classList.add('open'); envelope.classList.remove('idle'); }
  function closeLid(){ lid.classList.remove('open'); envelope.classList.add('idle'); }
  function animateNote(){ note.classList.remove('animate'); void note.offsetWidth; note.classList.add('animate'); }
  function openLetter(){ letter.classList.add('open'); lines.forEach((ln,i)=>setTimeout(()=>ln.classList.add('show'),150+i*100)); }
  function closeLetter(){ lines.forEach(ln=>ln.classList.remove('show')); letter.classList.remove('open'); }
  function toState(newState){
    state=newState;
    if(state===0){ closeLid(); note.classList.remove('animate'); closeLetter(); }
    else if(state===1){ openLid(); animateNote(); closeLetter(); }
    else if(state===2){ openLid(); note.classList.remove('animate'); setTimeout(()=>openLetter(),200); }
  }

  clickArea.addEventListener('click',()=>{
    // B·∫≠t nh·∫°c khi click l·∫ßn ƒë·∫ßu
    if(music.paused){
      music.play().catch(err=>console.log('Mobile kh√¥ng cho auto play nh·∫°c'));
    }

    const guideLetter = document.getElementById('guideLetter');
    if(state===0){ if(guide){ guide.style.animation='fadeOut 0.6s forwards'; } if(guideLetter){ guideLetter.style.display='flex'; guideLetter.style.animation='fadeIn 1s ease forwards'; } toState(1); }
    else if(state===1){ if(guideLetter){ guideLetter.style.animation='fadeOut 0.6s forwards'; setTimeout(()=>guideLetter.style.display='none',600); } toState(2); }
    else if(state===2){ toState(0); state=0; if(guide){ guide.style.display='flex'; guide.style.animation='fadeIn 1s ease forwards'; } }
  });

  const container = document.getElementById('blingContainer');
  const numBling = 80;
  for(let i=0;i<numBling;i++){
    const star=document.createElement('div'); star.className='bling';
    star.style.left=Math.random()*100+'%';
    star.style.top=Math.random()*100+'%';
    star.style.animationDelay=(Math.random()*3)+'s';
    star.style.animationDuration=(1.5+Math.random()*1.5)+'s';
    container.appendChild(star);
  }

  function createHearts(){
  const heartIcons = ['‚ôàÔ∏è','‚ù§Ô∏è','ü•∞','‚ôçÔ∏è','üíô','üòò']; // C√°c lo·∫°i tr√°i tim
  const numHearts = 3; // S·ªë tr√°i tim m·ªói l·∫ßn t·∫°o

  for(let i=0; i<numHearts; i++){
    const heart = document.createElement('div');
    heart.className = 'heart';
    
    // Ch·ªçn icon tr√°i tim ng·∫´u nhi√™n
    heart.innerText = heartIcons[Math.floor(Math.random() * heartIcons.length)];
    
    // V·ªã tr√≠ ngang ng·∫´u nhi√™n
    heart.style.left = Math.random()*100 + 'vw';
    // K√≠ch th∆∞·ªõc ng·∫´u nhi√™n
    heart.style.fontSize = (12 + Math.random()*24) + 'px';
    // T·ªëc ƒë·ªô bay ng·∫´u nhi√™n
    heart.style.animationDuration = (4 + Math.random()*5) + 's';
    // G√≥c xoay ng·∫´u nhi√™n
    heart.style.transform = `rotate(${Math.random()*360}deg)`;
    
    document.body.appendChild(heart);
    setTimeout(()=>heart.remove(), 10000); // X√≥a tr√°i tim sau 9s
  }
}

// T·∫°o tr√°i tim li√™n t·ª•c
setInterval(createHearts, 400);

})();
</script>
</body>
</html>
